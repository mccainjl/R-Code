setwd("C:/Users/wmcla/desktop/repos/R-Code")
getwd()
ratings1Zach<-read.csv(file="Ratings1Zach.csv",
header=FALSE, # header=TRUE is the default in read.csv so this is unnecessary
col.names=c("Picture","Question","Questiontext","ZachRating","ZachComments1"))
attach(ratings1Zach)
ratings1Zachwide<-reshape(ratings1Zach,direction="wide",timevar="Question",idvar="Picture")
head(ratings1Zachwide)
selfieurls<-read.csv(file="selfieurls.csv",header=FALSE,col.names=c("Url","Subject","Pictureletter"))
ratings1Zachwide$Subject<-selfieurls$Subject[1:188]
ratings1Zachwide$Pictureletter<-selfieurls$Pictureletter[1:188]
detach(ratings1Zach)
ratings1Nevill<-read.csv(file="Ratings1Nevill.csv",
header=FALSE, # header=TRUE is the default in read.csv so this is unnecessary
col.names=c("Picture","Question","Questiontext","NevillRating","NevillComments1"))
attach(ratings1Nevill)
ratings1Nevillwide<-reshape(ratings1Nevill,direction="wide",timevar="Question",idvar="Picture")
head(ratings1Nevillwide)
ratings1Nevillwide$Subject<-selfieurls$Subject[1:188]
ratings1Nevillwide$Pictureletter<-selfieurls$Pictureletter[1:188]
detach(ratings1Nevill)
ratings2Zach<-read.csv(file="Ratings2Zach.csv",
header=FALSE, # header=TRUE is the default in read.csv so this is unnecessary
col.names=c("Picture","Question","Questiontext","ZachRating","ZachComments1"))
attach(ratings2Zach)
#?reshape()
ratings2Zachwide<-reshape(ratings2Zach,direction="wide",timevar="Question",idvar="Picture")
head(ratings2Zachwide)
ratings2Zachwide$Subject<-selfieurls$Subject[189:376]
ratings2Zachwide$Pictureletter<-selfieurls$Pictureletter[189:376]
detach(ratings2Zach)
ratings2Nevill<-read.csv(file="Ratings2Nevill.csv",
header=FALSE, # header=TRUE is the default in read.csv so this is unnecessary
col.names=c("Picture","Question","Questiontext","NevillRating","NevillComments1"))
attach(ratings2Nevill)
#?reshape()
ratings2Nevillwide<-reshape(ratings2Nevill,direction="wide",timevar="Question",idvar="Picture")
head(ratings2Nevillwide)
ratings2Nevillwide$Subject<-selfieurls$Subject[189:376]
ratings2Nevillwide$Pictureletter<-selfieurls$Pictureletter[189:376]
detach(ratings2Nevill)
df1<-data.frame(ratings1Zachwide,ratings1Nevillwide)
df2<-data.frame(ratings2Zachwide,ratings2Nevillwide)
ratings<-rbind(df1,df2)
ratingsreduced <- ratings[c(1,21,24,27,30,33,36,39,42,45,48,51,75,78,81,84,87,90,93,96,99,102,105,107:108)]
ratingsreduced[c(2:23),]<-as.numeric(sapply(ratingsreduced[c(2:23),],as.character))
detach(ratings)
attach(ratingsreduced)
narcissistic<-(ZachRating.Q2_1+NevillRating.Q2_1)/2
View(ratingsreduced[c(2:23)])
ratingsreduced[c(2:23),]<-as.numeric(ratingsreduced[c(2:23),])
sapply(
ratingsreduced[c(2:23),]<-as.numeric(sapply(ratingsreduced[c(2:23),],as.character))
ratingsreduced[c(2:23),]<-as.numeric(sapply(ratingsreduced[c(2:23),],as.character))
type(ratingsreduced[c(2:23)])
typeof(ratingsreduced[c(2:23)])
typeof(ratingsreduced[2,3])
typeof(ratingsreduced[2,1])
narcissistic<-mean(ZachRating.Q2_1+NevillRating.Q2_1)
narcissistic<-mean(ZachRating.Q2_1,NevillRating.Q2_1)
?sapply()
narcissistic<-mean(c(ZachRating.Q2_1,NevillRating.Q2_1))
View(ratingsreduced)
ratingsreduced$narcissistic<-mean(c(ZachRating.Q2_1,NevillRating.Q2_1))
View(ratingsreduced)
ratingsreduced$narcissistic<-lapply(c(ZachRating.Q2_1,NevillRating.Q2_1),mean)
ratingsreduced$narcissistic<-rowmeans(c(ZachRating.Q2_1,NevillRating.Q2_1),na.rm = TRUE)
ratingsreduced$narcissistic<-rowMeans(c(ZachRating.Q2_1,NevillRating.Q2_1),na.rm = TRUE)
ratingsreduced$narcissistic<-rowMeans(radingsreduced[c(ZachRating.Q2_1,NevillRating.Q2_1),],na.rm = TRUE)
ratingsreduced$narcissistic<-rowMeans(ratingsreduced[c(ZachRating.Q2_1,NevillRating.Q2_1),],na.rm = TRUE)
typeof(ratingsreduced[c((ZachRating.Q2_1,NevillRating.Q2_1))])
typeof(ratingsreduced[c(ZachRating.Q2_1,NevillRating.Q2_1)])
typeof(ratingsreduced[c(2,13])
typeof(ratingsreduced[c(2,13)])
ratingsreduced$narcissistic<-rowMeans(ratingsreduced[c(2,13),],na.rm = TRUE)
typeof(ratingsreduced[c(2,23)])
typeof(ratingsreduced)
as.data.frame(ratingsreduced)
ratingsreduced$narcissistic<-rowMeans(ratingsreduced[c(2,13),],na.rm = TRUE)
ratingsreduced[c(2:23),]<-as.numeric(sapply(ratingsreduced[c(2:23),],as.character))
typeof(ratingsreduced)
ratingsreduced[c(2:23),]<-(sapply(ratingsreduced[c(2:23),]as.numeric))
typeof(ratingsreduced)
as.data.frame(ratingsreduced)
typeof(ratingsreduced)
ratingsreduced$narcissistic<-rowMeans(ratingsreduced[c(2,13),],na.rm = TRUE)
ratingsreduced$narcissistic<-rowMeans(sapply(ratingsreduced[c(2,13),],as.numeric),na.rm = TRUE)
View(ratingsreduced)
ratingsreduced
ratingsreduced$narcissistic<-rowMeans(sapply(ratingsreduced[c(2,13),],as.numeric),na.rm = TRUE)
ratingsreduced$selfesteem<-rowMeans(sapply(ratingsreduced[c(3,14),],as.numeric),na.rm = TRUE)
ratingsreduced$likeable<-rowMeans(sapply(ratingsreduced[c(4,15),],as.numeric),na.rm = TRUE)
ratingsreduced$attractive<-rowMeans(sapply(ratingsreduced[c(5,16),],as.numeric),na.rm = TRUE)
ratingsreduced$status<-rowMeans(sapply(ratingsreduced[c(6,17),],as.numeric),na.rm = TRUE)
ratingsreduced$intelligent<-rowMeans(sapply(ratingsreduced[c(7,18),],as.numeric),na.rm = TRUE)
ratingsreduced$kind<-rowMeans(sapply(ratingsreduced[c(8,19),],as.numeric),na.rm = TRUE)
ratingsreduced$caring<-rowMeans(sapply(ratingsreduced[c(9,20),],as.numeric),na.rm = TRUE)
ratingsreduced$warm<-rowMeans(sapply(ratingsreduced[c(10,21),],as.numeric),na.rm = TRUE)
ratingsreduced$friendly<-rowMeans(sapply(ratingsreduced[c(11,22),],as.numeric),na.rm = TRUE)
ratingsreduced$driven<-rowMeans(sapply(ratingsreduced[c(12,23),],as.numeric),na.rm = TRUE)
View(ratingsreduced)
#ICC's
install.packages("irr")
library(irr)
?icc()
icc(t(ratings[complete.cases(ratings[,c(2,13)]),c(2,13)]))
icc(t(ratingsreduced[complete.cases(ratingsreduced[,c(2,13)]),c(2,13)]))
icc(t(ratingsreduced[complete.cases(ratingsreduced[c(2,13),]))
icc(t(ratingsreduced[complete.cases(ratingsreduced[c(2,13),])))
icc(ratingsreduced[complete.cases(ratingsreduced[c(2,13),])))
icc(t(ratings[complete.cases(ratings[,c(9,54)]),c(9,54)]))
icc(t(ratings[complete.cases(ratings[,c(10,55)]),c(10,55)]))
icc(t(ratings[complete.cases(ratings[,c(11,56)]),c(11,56)]))
icc(t(ratings7[complete.cases(ratings7[,c(12,57)]),c(12,57)]))
icc(t(ratings[complete.cases(ratings[,c(13,58)]),c(13,58)]))
icc(t(ratings[complete.cases(ratings[,c(14,59)]),c(14,59)]))
icc(t(ratings[complete.cases(ratings[,c(15,60)]),c(15,60)]))
icc(t(ratings[complete.cases(ratings[,c(16,61)]),c(16,61)]))
icc(t(ratings[complete.cases(ratings[,c(17,62)]),c(17,62)]))
icc(t(ratings[complete.cases(ratings[,c(18,63)]),c(18,63)]))
icc(t(ratings[complete.cases(ratings[,c(19,64)]),c(19,64)]))
icc(t(ratings[complete.cases(ratings[,c(20,65)]),c(20,65)]))
icc(t(ratings[complete.cases(ratings[,c(21,66)]),c(21,66)]))
icc(t(ratings[complete.cases(ratings[,c(22,67)]),c(22,67)]))
icc(t(ratings[complete.cases(ratings[,c(23,68)]),c(23,68)]))
?t()
icc(t(ratingsreduced[complete.cases(ratingsreduced[c(2,13),])]))
icc(ratingsreduced[complete.cases(ratingsreduced[c(2,13),])])
icc(t(ratingsreduced[complete.cases(ratingsreduced[,c(2,13),c(2,13)])]))
View(t(ratingsreduced[complete.cases(ratingsreduced[,c(2,13),c(2,13)])]))
View(t(ratingsreduced[complete.cases(ratingsreduced[,c(2,13)])]))
View(t(ratingsreduced[complete.cases(ratingsreduced[c(2,13)])]))
IRTdatashort<-read.csv(file="IRTdatashort.csv")
IRTdatashort<-read.csv(file="IRTdatashort.csv")
IRTdata<-read.csv(file="IRTdata.csv")
diIRT<-read.csv(file="dichotomousirtdata2.csv")
install.packages("CTT")
install.packages("CTT")
install.packages("mirt")
library(CTT)
library(mirt)
summary(IRTdata)
summary(IRTdatashort)
IRTdatashort[IRTdatashort==999]<-NA
IRTdata[IRTdata==999]<-NA
str(reliability(diirt),vector.len=1000)
str(reliability(diIRT),vector.len=1000)
reliability(IRTdata,output.scored=TRUE)
reliability(IRTdata)
CNItotal<-rowSums(IRTdata,na.rm=T)
IRTscored<-data.frame(IRTdata,CNItotal)
reliability(IRTdatashort)
CNIrel<-reliability(diIRT)
CNIrel$bis
CNIrel$alphaIfDeleted
CNIrel$itemMean
cttICC(IRTscored$CNItotal,IRTscored$CNI1,plotTitle="ICC for Item 1",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI2,plotTitle="ICC for Item 2",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI3,plotTitle="ICC for Item 3",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI4,plotTitle="ICC for Item 4",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI5,plotTitle="ICC for Item 5",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI6,plotTitle="ICC for Item 6",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI7,plotTitle="ICC for Item 7",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI8,plotTitle="ICC for Item 8",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI9,plotTitle="ICC for Item 9",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI10,plotTitle="ICC for Item 10",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI11,plotTitle="ICC for Item 11",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI12,plotTitle="ICC for Item 12",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI13,plotTitle="ICC for Item 13",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI14,plotTitle="ICC for Item 14",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI15,plotTitle="ICC for Item 15",xlab="CNI Total Score",ylab="Proportion Correct (p)")
cttICC(IRTscored$CNItotal,IRTscored$CNI16,plotTitle="ICC for Item 16",xlab="CNI Total Score",ylab="Proportion Correct (p)")
frame<cbind(testscores$score,testscores$scored)
View(IRTdata)
cnigrm<-mirt(IRTdata,1,"graded",technical=list(NCYCLES=50000))
scores<-fscores(cnigrm,method='EAP',full.scores=TRUE,scores.only=TRUE)
fullIRTdata<-imputeMissing(cnigrm,scores)
cnigrm<-mirt(fullIRTdata,1,"graded",technical=list(NCYCLES=50000))
cnigrm
str(cnigrm)
is.na(cnigrmshort)
is.na(cnigrm)
show(cnigrm)
cnigpcm<-mirt(IRTdata,1,"gpcm",technical=list(NCYCLES=50000))
scores<-fscores(cnigpcm,method='EAP',full.scores=TRUE,scores.only=TRUE)
fullIRTdatagpcm<-imputeMissing(cnigpcm,scores)
cnigpcm<-mirt(fullIRTdatagpcm,1,"gpcm",technical=list(NCYCLES=50000))
coef(cnigrm,IRTpars=TRUE,simplify=TRUE)
coef(cnigpcm,IRTpars=TRUE,simplify=TRUE)
M2(cnigrm)
M2(cnigpcm)
plot(cnigrm,theta_lim=c(-3,3))
plot(cnigpcm,theta_lim=c(-3,3))
plot(cninom,theta_lim=c(-3,3))
plot(cnigrm,type='info',theta_lim=c(-3,3))
plot(cnigpcm,type='info',theta_lim=c(-3,3))
plot(cninom,type='info',theta_lim=c(-3,3))
anova(cnigrm,cnigpcm)
anova(cnigpcm,cninom)
cninom<-mirt(IRTdata,1,"nominal",technical=list(NCYCLES=50000))
scores<-fscores(cninom,method='EAP',full.scores=TRUE,scores.only=TRUE)
fullIRTdatanom<-imputeMissing(cninom,scores)
cninom<-mirt(fullIRTdatanom,1,"nominal",technical=list(NCYCLES=50000))
anova(cnigrm,cnigpcm)
anova(cnigpcm,cninom)
anova(cnigrm,cninom)
itemfit(cnigrm)
itemfit(cnigpcm)
itemfit(cninom)
dput(head(IRTdata))
CNIrel<-reliability(IRTdata)
CNIrel$bis
CNIrel$alphaIfDeleted
CNIrel$itemMean
